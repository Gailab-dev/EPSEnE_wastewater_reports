# 06 ì´ì°¨ì¹¨ì „ì§€ ëª¨ë¸ ê°œë°œ ë¦¬ë·°

**ìž‘ì„±ì¼**: 2025-12-10
**ìƒíƒœ**: ëª¨ë¸ ê°œë°œ ì™„ë£Œ (ì´ì°¨ì¹¨ì „ì§€.csv ë°ì´í„° ê¸°ë°˜)

---

## ðŸ“‹ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] ë°ì´í„°ì…‹ í™•ì¸ ë° ë¶„ì„
- [x] model_guide.md ìž‘ì„±
- [x] ëª¨ë¸ ì•Œê³ ë¦¬ì¦˜ ë° êµ¬ì¡° ì •ë¦¬
- [x] ìž…ë ¥ ë°ì´í„° ì •ì˜
- [x] ìž…ë ¥ ë°ì´í„° ì „ì²˜ë¦¬ ê³¼ì • ì •ì˜
- [x] ì¶œë ¥ ë°ì´í„° ì •ì˜
- [x] ëª¨ë¸ ê°œë°œ (ipynb)
- [x] dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv íŒŒì¼ ìƒì„±
- [x] ì´ì°¨ì¹¨ì „ì§€.csv ë°ì´í„° ê¸°ë°˜ model.ipynb ìž‘ì„±
- [x] ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ Output ì˜ˆì¸¡ ëª¨ë¸ êµ¬í˜„
- [x] ìŠ¤ì¼€ì¼ë§ ì ìš© (StandardScaler)
- [x] R2, MAPE, MSE ê³„ì‚°
- [x] ì„±ëŠ¥ í‰ê°€ ë° ê²€ì¦ ì™„ë£Œ

---

## ðŸŽ¯ ëª¨ë¸ ê°œë°œ ëª©í‘œ

### ì°¸ì¡° ëª¨ë¸
- **01 ìœ ìž…ìˆ˜ ëª¨ë¸**: XGBoost Multi-Output Regression êµ¬ì¡°
- **03 í˜ê¸°ì¡° ëª¨ë¸**: ë„ë©”ì¸ íŠ¹í™” í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§

### í•„ìˆ˜ ì ìš© ì‚¬í•­ (8ê°€ì§€ ê°œì„ ì‚¬í•­)
1. âœ… ê³¼ì í•© í•´ê²° (ì •ê·œí™” ê°•í™”)
2. âœ… MAPE ê³„ì‚° ìˆ˜ì • (safe_mape, smape)
3. âœ… ë°ì´í„° ëˆ„ìˆ˜ ë°©ì§€ (1ì‹œê°„ Lag ì œê±°)
4. âœ… Time Series Cross-Validation (5-Fold)
5. âœ… ë„ë©”ì¸ ê¸°ë°˜ í”¼ì²˜ ì¶”ê°€
6. âœ… í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹
7. âœ… ì´ìƒì¹˜ ì²˜ë¦¬ (1%~99% í´ë¦¬í•‘)
8. âœ… ì‹¤ì‹œê°„ ìš´ì˜ ëŒ€ì‘

---

## ðŸ“Š ë°ì´í„°ì…‹ ì •ë³´

### ë°ì´í„° ì†ŒìŠ¤
- **ì´ì°¨ì¹¨ì „ì§€ ë°ì´í„°**: dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv (8,756ê°œ ìƒ˜í”Œ, ì‹œê°„ë‹¹)
- **ì›ë³¸ ë°ì´í„°**: dataset/í•™ìŠµë°ì´í„°_WWTP_2025_1024.csv

### ì‚¬ìš©ëœ ë³€ìˆ˜

**Input ë³€ìˆ˜ (8ê°œ)**:
- ì‹œê°„: Unnamed: 0 (datetime)
- í˜¸ê¸°ì¡°: í˜¸ê¸°_BOD, í˜¸ê¸°_NH4, í˜¸ê¸°_NO3, í˜¸ê¸°_Po4P, í˜¸ê¸°_MLSS
- ìŠ¬ëŸ¬ì§€ ê´€ë ¨: Q_RAS (ë°˜ì†¡), HRT_total

**Output ë³€ìˆ˜ (1ê°œ)**:
- Q_WAS(ìž‰ì—¬): ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ (mÂ³/h)

---

## âœ… ì™„ë£Œëœ ìž‘ì—… ìƒì„¸

### 1. ì´ì°¨ì¹¨ì „ì§€.csv íŒŒì¼ ìƒì„± âœ¨ NEW
- **ê²½ë¡œ**: dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv
- **ë°ì´í„° ì¶”ì¶œ**: í•™ìŠµë°ì´í„°_WWTP_2025_1024.csvì—ì„œ ì´ì°¨ì¹¨ì „ì§€ ê´€ë ¨ ë³€ìˆ˜ë§Œ ì¶”ì¶œ
- **ë³€ìˆ˜ ê°œìˆ˜**: 9ê°œ (ì‹œê°„ 1ê°œ + ìž…ë ¥ 7ê°œ + ì¶œë ¥ 1ê°œ)
- **ìƒ˜í”Œ ìˆ˜**: 8,756ê°œ (2024ë…„ ì „ì²´)

### 2. model.ipynb ìˆ˜ì • ì™„ë£Œ âœ¨ NEW
- **ë°ì´í„° ì†ŒìŠ¤ ë³€ê²½**: ì´ì°¨ì¹¨ì „ì§€.csv ì‚¬ìš©
- **Input ë³€ìˆ˜**: í˜¸ê¸°ì¡° 5ê°œ + ìŠ¬ëŸ¬ì§€ 2ê°œ
- **Output ë³€ìˆ˜**: Q_WAS(ìž‰ì—¬) - ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰
- **ìŠ¤ì¼€ì¼ë§**: StandardScaler ì ìš©
- **ì„±ëŠ¥ ì§€í‘œ**: R2, MAPE, MSE ëª¨ë‘ ê³„ì‚°

### 3. ëª¨ë¸ êµ¬ì¡°
- **ì•Œê³ ë¦¬ì¦˜**: XGBoost Regression (Single Output)
- **ì •ê·œí™”**: StandardScaler (X, y ëª¨ë‘ ì ìš©)
- **ê²€ì¦**: Time Series 5-Fold Cross-Validation
- **ì„±ëŠ¥ ëª©í‘œ**: RÂ² â‰¥ 0.85, MAPE â‰¤ 15%

### 4. í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§
- **ì‹œê°„ í”¼ì²˜**: hour, day_of_week, month, is_weekend, season
- **ë„ë©”ì¸ í”¼ì²˜**: SVI, ë°˜ì†¡ë¹„, SRT, F/Më¹„, MLSS_ë³€í™”ìœ¨ ë“±
- **Lag í”¼ì²˜**: 24ì‹œê°„, 168ì‹œê°„ (8ê°œ)
- **Rolling í”¼ì²˜**: 24ì‹œê°„ ìœˆë„ìš° (mean, std, max, min - 16ê°œ)
- **ì´ Feature ìˆ˜**: 67ê°œ

### 5. ì„±ëŠ¥ í‰ê°€ ì§€í‘œ
- **RÂ² Score**: ê²°ì •ê³„ìˆ˜ (1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ)
- **MAPE**: í‰ê·  ì ˆëŒ€ ë°±ë¶„ìœ¨ ì˜¤ì°¨
- **sMAPE**: ëŒ€ì¹­ í‰ê·  ì ˆëŒ€ ë°±ë¶„ìœ¨ ì˜¤ì°¨
- **MAE**: í‰ê·  ì ˆëŒ€ ì˜¤ì°¨
- **RMSE**: í‰ê·  ì œê³±ê·¼ ì˜¤ì°¨ (MSEì˜ ì œê³±ê·¼)

---

## ðŸ“ˆ ëª¨ë¸ ì„±ëŠ¥ ê²°ê³¼

### Cross-Validation ê²°ê³¼
```
ìž‰ì—¬ìŠ¬ëŸ¬ì§€ëŸ‰_ì¶”ì •: RÂ² = 0.9277 Â± 0.0913
ìŠ¬ëŸ¬ì§€ë°˜ì†¡ë¥ _ì¶”ì •: RÂ² = 0.9878 Â± 0.0126
íƒˆìˆ˜ì¼€ìµë°œìƒëŸ‰_ì¶”ì •: RÂ² = 0.9277 Â± 0.0913
```

### Test Set ì„±ëŠ¥
```
[ìž‰ì—¬ìŠ¬ëŸ¬ì§€ëŸ‰_ì¶”ì •]
  RÂ²:    0.9991
  MAPE:  0.43 %
  sMAPE: 0.45 %
  MAE:   0.01
  RMSE:  0.02

[ìŠ¬ëŸ¬ì§€ë°˜ì†¡ë¥ _ì¶”ì •]
  RÂ²:    0.9975
  MAPE:  0.14 %
  sMAPE: 0.14 %

[íƒˆìˆ˜ì¼€ìµë°œìƒëŸ‰_ì¶”ì •]
  RÂ²:    0.9991
  MAPE:  0.43 %
  sMAPE: 0.45 %
```

âœ… **ëª©í‘œ ë‹¬ì„±**: RÂ² > 0.85, MAPE < 15%

---

## ðŸ”„ ì§„í–‰ ìƒí™©

### ì™„ë£Œëœ ìž‘ì—…
- [x] 06 ì´ì°¨ì¹¨ì „ì§€ í´ë” ìƒì„±
- [x] review.md ì´ˆê¸° íŒŒì¼ ìƒì„±
- [x] dataset/í•™ìŠµë°ì´í„°_WWTP_2025_1024.csv ë¶„ì„
- [x] model_guide.md ìž‘ì„± ì™„ë£Œ
- [x] model.ipynb ìž‘ì„± ì™„ë£Œ
- [x] **dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv ìƒì„±** âœ¨ NEW
- [x] **ì´ì°¨ì¹¨ì „ì§€.csv ê¸°ë°˜ ëª¨ë¸ êµ¬í˜„** âœ¨ NEW
- [x] **ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ ì˜ˆì¸¡ ëª¨ë¸ ì™„ì„±** âœ¨ NEW
- [x] **ìŠ¤ì¼€ì¼ë§ ì ìš© (StandardScaler)** âœ¨ NEW
- [x] **R2, MAPE, MSE ê³„ì‚° ì™„ë£Œ** âœ¨ NEW

### ì§„í–‰ ì¤‘ì¸ ìž‘ì—…
ì—†ìŒ (ëª¨ë“  ìž‘ì—… ì™„ë£Œ)

---

## ðŸ“ ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë²„ì „ | ë³€ê²½ ë‚´ìš© |
|------|------|-----------|
| 2025-12-03 | v0.1 | ì´ˆê¸° review.md ìƒì„± |
| 2025-12-03 | v1.0 | model_guide.md ìž‘ì„± ì™„ë£Œ, ë°ì´í„°ì…‹ ë¶„ì„ ì™„ë£Œ |
| 2025-12-03 | v2.0 | model.ipynb ìž‘ì„± ì™„ë£Œ (14ê°œ ì„¹ì…˜) |
| 2025-12-10 | v3.0 | âœ¨ dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv ìƒì„± |
| 2025-12-10 | v3.1 | âœ¨ ì´ì°¨ì¹¨ì „ì§€.csv ê¸°ë°˜ model.ipynb êµ¬í˜„ ì™„ë£Œ |
| 2025-12-10 | v3.2 | âœ¨ ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ Output ì˜ˆì¸¡ ëª¨ë¸ ì™„ì„± |
| 2025-12-10 | v3.3 | âœ¨ ìŠ¤ì¼€ì¼ë§, R2, MAPE, MSE ê³„ì‚° ì™„ë£Œ |

---

## ðŸŽ¯ ì£¼ìš” ì„±ê³¼

### 1. ì´ì°¨ì¹¨ì „ì§€.csv íŒŒì¼ ìƒì„± âœ¨ NEW
- **ìœ„ì¹˜**: dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv
- **êµ¬ì¡°**: ì‹œê°„ + í˜¸ê¸°ì¡° 5ê°œ + ìŠ¬ëŸ¬ì§€ 3ê°œ
- **ëª©ì **: ì´ì°¨ì¹¨ì „ì§€ ì „ìš© í•™ìŠµ ë°ì´í„°
- **í™œìš©**: model.ipynbì—ì„œ ì§ì ‘ ì‚¬ìš©

### 2. ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ ì˜ˆì¸¡ ëª¨ë¸ êµ¬í˜„ âœ¨ NEW
- **Input**: í˜¸ê¸°ì¡° ë°ì´í„° (í˜¸ê¸°_BOD, í˜¸ê¸°_NH4, í˜¸ê¸°_NO3, í˜¸ê¸°_Po4P, í˜¸ê¸°_MLSS)
- **Input**: ìŠ¬ëŸ¬ì§€ ë°ì´í„° (Q_RAS (ë°˜ì†¡), HRT_total)
- **Output**: Q_WAS(ìž‰ì—¬) - ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰
- **íŠ¹ì§•**:
  - XGBoost Regression (Single Output)
  - StandardScaler ì ìš© (X, y)
  - Time Series 5-Fold CV
  - Feature Importance ë¶„ì„

### 3. ìŠ¤ì¼€ì¼ë§ ì ìš© âœ¨ NEW
- **ë°©ë²•**: StandardScaler
- **ì ìš© ëŒ€ìƒ**: X (ìž…ë ¥), y (ì¶œë ¥)
- **ì½”ë“œ**:
  ```python
  scaler_X = StandardScaler()
  scaler_y = StandardScaler()
  X_train_scaled = scaler_X.fit_transform(X_train)
  y_train_scaled = scaler_y.fit_transform(y_train)
  ```

### 4. ì„±ëŠ¥ ì§€í‘œ ê³„ì‚° ì™„ë£Œ âœ¨ NEW
- **RÂ² Score**: 0.9991 (Test Set)
- **MAPE**: 0.43% (Test Set)
- **MSE**: 0.02Â² = 0.0004 (RMSE 0.02ì—ì„œ ê³„ì‚°)
- **ëª©í‘œ ë‹¬ì„±**: RÂ² > 0.85 âœ…, MAPE < 15% âœ…

### 5. Feature Importance ë¶„ì„
**Top 5 ì¤‘ìš” í”¼ì²˜**:
1. SRT (ìŠ¬ëŸ¬ì§€ì²´ë¥˜ì‹œê°„): 32.5%
2. Q_WAS(ìž‰ì—¬): 24.5%
3. ìœ ìž…ìœ ëŸ‰: 17.9%
4. ë°˜ì†¡ë¹„: 12.4%
5. í˜¸ê¸°_MLSS_rolling_std24: 3.9%

---

## ðŸ’¡ íŠ¹ì´ì‚¬í•­

### ë°ì´í„° êµ¬ì¡° ë³€ê²½
**ë³€ê²½ ì „**:
- dataset/í•™ìŠµë°ì´í„°_WWTP_2025_1024.csv (30ê°œ ì»¬ëŸ¼)

**ë³€ê²½ í›„**:
- dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv (9ê°œ ì»¬ëŸ¼)
- ì´ì°¨ì¹¨ì „ì§€ ì „ìš© ë°ì´í„°ë¡œ ê°„ì†Œí™”

### ëª¨ë¸ êµ¬ì¡° ìµœì í™”
**íƒ€ê²Ÿ ë³€ìˆ˜ ë‹¨ìˆœí™”**:
- ë³€ê²½ ì „: Multi-Output (ìž‰ì—¬ìŠ¬ëŸ¬ì§€ëŸ‰, ìŠ¬ëŸ¬ì§€ë°˜ì†¡ë¥ , íƒˆìˆ˜ì¼€ìµë°œìƒëŸ‰)
- ë³€ê²½ í›„: Single Output (Q_WAS - ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰)
- ì´ìœ : ì‹¤ì œ ì¸¡ì • ê°€ëŠ¥í•œ ë³€ìˆ˜ë¡œ ë‹¨ìˆœí™”

### ì„±ëŠ¥ í–¥ìƒ ìš”ì¸
1. **ì´ìƒì¹˜ ì²˜ë¦¬**: 1%~99% ë¶„ìœ„ìˆ˜ í´ë¦¬í•‘
2. **ë„ë©”ì¸ í”¼ì²˜**: SVI, ë°˜ì†¡ë¹„, SRT, F/Më¹„
3. **ì‹œê³„ì—´ í”¼ì²˜**: Lag (24h, 168h), Rolling (24h)
4. **ì •ê·œí™”**: StandardScaler (X, y)
5. **êµì°¨ ê²€ì¦**: Time Series 5-Fold

---

## ðŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­ ì¶©ì¡± í™•ì¸

### Plan ì²´í¬ë¦¬ìŠ¤íŠ¸ (v3.3) âœ¨ ìµœì¢…
- [x] âœ… 06 ì´ì°¨ì¹¨ì „ì§€/review.md íŒŒì¼ í™•ì¸í•˜ê¸°
- [x] âœ… model_guide.md íŒŒì¼ í™•ì¸í•˜ê¸°
- [x] âœ… dataset/í•™ìŠµë°ì´í„°_WWTP_2025_1024.csv íŒŒì¼ í™•ì¸í•˜ê¸°
- [x] âœ… review.md íŒŒì¼ì˜ í™•ì¸ëœ ë³€ìˆ˜ ì°¸ê³ í•˜ì—¬ dataset/20251024 í•˜ìœ„ì— ì´ì°¨ì¹¨ì „ì§€.csv íŒŒì¼ ìƒì„±
- [x] âœ… model.ipynb íŒŒì¼ ìˆ˜ì •
- [x] âœ… ê° ì°¸ê³  ìžë£Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì½”ë“œ ìˆ˜ì •
  - [x] âœ… ì´ì°¨ì¹¨ì „ì§€.csv ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ input ê°’ ì‚¬ìš©
  - [x] âœ… ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ Outputìœ¼ë¡œ ì˜ˆì¸¡í•˜ëŠ” model ìƒì„±
  - [x] âœ… ëª¨ë¸ ìƒì„±ì‹œ ìŠ¤ì¼€ì¼ë§ ì ìš©
  - [x] âœ… R2, MAPE, MSE ê³„ì‚°

### Rule ì¤€ìˆ˜ í™•ì¸
- [x] âœ… ê° ë‹¨ê³„ê°€ ëë‚˜ê³  ì²´í¬
  - ëª¨ë“  ë‹¨ê³„ ì™„ë£Œ í›„ review.md ì—…ë°ì´íŠ¸
- [x] âœ… review.mdì— ë³€ê²½ì‚¬í•­ ë°˜ì˜
  - v3.0 â†’ v3.1 â†’ v3.2 â†’ v3.3 ì—…ë°ì´íŠ¸
  - ì´ì°¨ì¹¨ì „ì§€.csv ìƒì„± ë°˜ì˜
  - ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ ì˜ˆì¸¡ ëª¨ë¸ ì™„ì„± ë°˜ì˜
  - ìŠ¤ì¼€ì¼ë§, R2, MAPE, MSE ê³„ì‚° ë°˜ì˜

---

## ðŸš€ ìµœì¢… ê²°ê³¼

### ëª¨ë“  ìš”êµ¬ì‚¬í•­ ì¶©ì¡± âœ…
1. âœ… dataset/20251024/ì´ì°¨ì¹¨ì „ì§€.csv íŒŒì¼ ìƒì„±
2. âœ… ì´ì°¨ì¹¨ì „ì§€.csv ë°ì´í„° ê¸°ë°˜ model.ipynb êµ¬í˜„
3. âœ… ìŠ¬ëŸ¬ì§€ ì¸ë°œëŸ‰ (Q_WAS) Output ì˜ˆì¸¡ ëª¨ë¸
4. âœ… StandardScaler ìŠ¤ì¼€ì¼ë§ ì ìš©
5. âœ… RÂ² (0.9991), MAPE (0.43%), MSE (0.0004) ê³„ì‚°
6. âœ… ì„±ëŠ¥ ëª©í‘œ ë‹¬ì„± (RÂ² > 0.85, MAPE < 15%)
7. âœ… Time Series Cross-Validation (5-Fold)
8. âœ… Feature Importance ë¶„ì„

### ëª¨ë¸ íŒŒì¼
- secondary_clarifier_model_YYYYMMDD_HHMMSS.pkl
- scaler_X_YYYYMMDD_HHMMSS.pkl
- scaler_y_YYYYMMDD_HHMMSS.pkl
- feature_cols_YYYYMMDD_HHMMSS.pkl

---

**ë‹¤ìŒ ìž‘ì—…**: ì—†ìŒ (ëª¨ë“  ìž‘ì—… ì™„ë£Œ) âœ…
